/**
 * 中文转拼音首字母工具
 * 用于将中文姓名转换为拼音首字母（大写）
 */

// 常见中文字符到拼音首字母的映射表
// 此表包含了常用的汉字及其拼音首字母
const PINYIN_MAP: Record<string, string> = {
  // 常见姓氏
  '赵': 'Z', '钱': 'Q', '孙': 'S', '李': 'L', '周': 'Z', '吴': 'W', '郑': 'Z', '王': 'W',
  '冯': 'F', '陈': 'C', '褚': 'C', '卫': 'W', '蒋': 'J', '沈': 'S', '韩': 'H', '杨': 'Y',
  '朱': 'Z', '秦': 'Q', '尤': 'Y', '许': 'X', '何': 'H', '吕': 'L', '施': 'S', '张': 'Z',
  '孔': 'K', '曹': 'C', '严': 'Y', '华': 'H', '金': 'J', '魏': 'W', '陶': 'T', '姜': 'J',
  '戚': 'Q', '谢': 'X', '邹': 'Z', '喻': 'Y', '柏': 'B', '水': 'S', '窦': 'D', '章': 'Z',
  '云': 'Y', '苏': 'S', '潘': 'P', '葛': 'G', '奚': 'X', '范': 'F', '彭': 'P', '郎': 'L',
  '鲁': 'L', '韦': 'W', '昌': 'C', '马': 'M', '苗': 'M', '凤': 'F', '花': 'H', '方': 'F',
  '俞': 'Y', '任': 'R', '袁': 'Y', '柳': 'L', '酆': 'F', '鲍': 'B', '史': 'S', '唐': 'T',
  '费': 'F', '廉': 'L', '岑': 'C', '薛': 'X', '雷': 'L', '贺': 'H', '倪': 'N', '汤': 'T',
  '滕': 'T', '殷': 'Y', '罗': 'L', '毕': 'B', '郝': 'H', '邬': 'W', '安': 'A', '常': 'C',
  '乐': 'L', '于': 'Y', '时': 'S', '傅': 'F', '皮': 'P', '卞': 'B', '齐': 'Q', '康': 'K',
  '伍': 'W', '余': 'Y', '元': 'Y', '卜': 'B', '顾': 'G', '孟': 'M', '平': 'P', '黄': 'H',
  '和': 'H', '穆': 'M', '萧': 'X', '尹': 'Y', '姚': 'Y', '邵': 'S', '湛': 'Z', '汪': 'W',
  '祁': 'Q', '毛': 'M', '禹': 'Y', '狄': 'D', '米': 'M', '贝': 'B', '明': 'M', '臧': 'Z',
  '计': 'J', '伏': 'F', '成': 'C', '戴': 'D', '谈': 'T', '宋': 'S', '茅': 'M', '庞': 'P',
  '熊': 'X', '纪': 'J', '舒': 'S', '屈': 'Q', '项': 'X', '祝': 'Z', '董': 'D', '梁': 'L',
  '杜': 'D', '阮': 'R', '蓝': 'L', '闵': 'M', '席': 'X', '季': 'J', '麻': 'M', '强': 'Q',
  '贾': 'J', '路': 'L', '娄': 'L', '危': 'W', '江': 'J', '童': 'T', '颜': 'Y', '郭': 'G',
  '梅': 'M', '盛': 'S', '林': 'L', '刁': 'D', '钟': 'Z', '徐': 'X', '邱': 'Q', '骆': 'L',
  '高': 'G', '夏': 'X', '蔡': 'C', '田': 'T', '樊': 'F', '胡': 'H', '凌': 'L', '霍': 'H',
  '虞': 'Y', '万': 'W', '支': 'Z', '柯': 'K', '昝': 'Z', '管': 'G', '卢': 'L', '莫': 'M',
  '经': 'J', '房': 'F', '裘': 'Q', '缪': 'M', '干': 'G', '解': 'X', '应': 'Y', '宗': 'Z',
  '丁': 'D', '宣': 'X', '贲': 'B', '邓': 'D', '郁': 'Y', '单': 'S', '杭': 'H', '洪': 'H',
  '包': 'B', '诸': 'Z', '左': 'Z', '石': 'S', '崔': 'C', '吉': 'J', '钮': 'N', '龚': 'G',
  '程': 'C', '嵇': 'J', '邢': 'X', '滑': 'H', '裴': 'P', '陆': 'L', '荣': 'R', '翁': 'W',
  '荀': 'X', '羊': 'Y', '於': 'Y', '惠': 'H', '甄': 'Z', '曲': 'Q', '家': 'J', '封': 'F',
  '芮': 'R', '羿': 'Y', '储': 'C', '靳': 'J', '汲': 'J', '邴': 'B', '糜': 'M', '松': 'S',
  '井': 'J', '段': 'D', '富': 'F', '巫': 'W', '乌': 'W', '焦': 'J', '巴': 'B', '弓': 'G',
  '牧': 'M', '隗': 'W', '山': 'S', '谷': 'G', '车': 'C', '侯': 'H', '宓': 'M', '蓬': 'P',
  '全': 'Q', '郗': 'X', '班': 'B', '仰': 'Y', '秋': 'Q', '仲': 'Z', '伊': 'Y', '宫': 'G',
  '宁': 'N', '仇': 'Q', '栾': 'L', '暴': 'B', '甘': 'G', '钭': 'T', '厉': 'L', '戎': 'R',
  '祖': 'Z', '武': 'W', '符': 'F', '刘': 'L', '景': 'J', '詹': 'Z', '束': 'S', '龙': 'L',
  '叶': 'Y', '幸': 'X', '司': 'S', '韶': 'S', '郜': 'G', '黎': 'L', '蓟': 'J', '薄': 'B',
  '印': 'Y', '宿': 'S', '白': 'B', '怀': 'H', '蒲': 'P', '邰': 'T', '从': 'C', '鄂': 'E',
  '索': 'S', '咸': 'X', '籍': 'J', '赖': 'L', '卓': 'Z', '蔺': 'L', '屠': 'T', '蒙': 'M',
  '池': 'C', '乔': 'Q', '阴': 'Y', '胥': 'X', '能': 'N', '苍': 'C', '双': 'S',
  '闻': 'W', '莘': 'S', '党': 'D', '翟': 'Z', '谭': 'T', '贡': 'G', '劳': 'L', '逄': 'P',
  '姬': 'J', '申': 'S', '扶': 'F', '堵': 'D', '冉': 'R', '宰': 'Z', '郦': 'L', '雍': 'Y',
  '却': 'Q', '璩': 'Q', '桑': 'S', '桂': 'G', '濮': 'P', '牛': 'N', '寿': 'S', '通': 'T',
  '边': 'B', '扈': 'H', '燕': 'Y', '冀': 'J', '郏': 'J', '浦': 'P', '尚': 'S', '农': 'N',
  '温': 'W', '别': 'B', '庄': 'Z', '晏': 'Y', '柴': 'C', '瞿': 'Q', '阎': 'Y', '充': 'C',
  '慕': 'M', '连': 'L', '茹': 'R', '习': 'X', '宦': 'H', '艾': 'A', '鱼': 'Y', '容': 'R',
  '向': 'X', '古': 'G', '易': 'Y', '慎': 'S', '戈': 'G', '廖': 'L', '庾': 'Y', '终': 'Z',
  '暨': 'J', '居': 'J', '衡': 'H', '步': 'B', '都': 'D', '耿': 'G', '满': 'M', '弘': 'H',
  '匡': 'K', '国': 'G', '文': 'W', '寇': 'K', '广': 'G', '禄': 'L', '阙': 'Q', '东': 'D',
  '欧': 'O', '殳': 'S', '沃': 'W', '利': 'L', '蔚': 'W', '越': 'Y', '夔': 'K', '隆': 'L',
  '师': 'S', '巩': 'G', '厍': 'S', '聂': 'N', '晁': 'C', '勾': 'G', '敖': 'A', '融': 'R',
  '冷': 'L', '訾': 'Z', '辛': 'X', '阚': 'K', '那': 'N', '简': 'J', '饶': 'R', '空': 'K',
  '曾': 'Z', '毋': 'W', '沙': 'S', '乜': 'N', '养': 'Y', '鞠': 'J', '须': 'X', '丰': 'F',
  '巢': 'C', '关': 'G', '蒯': 'K', '相': 'X', '查': 'Z', '后': 'H', '荆': 'J', '红': 'H',
  '游': 'Y', '竺': 'Z', '权': 'Q', '逯': 'L', '盖': 'G', '益': 'Y', '桓': 'H', '公': 'G',
  '仉': 'Z', '督': 'D', '岳': 'Y', '帅': 'S', '缑': 'G', '亢': 'K', '况': 'K', '郈': 'H',
  '有': 'Y', '琴': 'Q', '归': 'G', '海': 'H', '墨': 'M', '哈': 'H', '年': 'N', '爱': 'A',
  '阳': 'Y', '佟': 'T', '言': 'Y', '福': 'F', '赫': 'H', '萨': 'S', '伯': 'B', '隋': 'S',
  '司马': 'S', '上官': 'S', '欧阳': 'O', '夏侯': 'X', '诸葛': 'Z', '东方': 'D', '皇甫': 'H',
  '尉迟': 'Y', '公孙': 'G', '令狐': 'L', '宇文': 'Y', '长孙': 'Z', '慕容': 'M', '司徒': 'S',
  '司空': 'S', '端木': 'D',

  // 常见名字用字（去除与姓氏重复的字符）
  '一': 'Y', '二': 'E', '三': 'S', '四': 'S', '五': 'W', '六': 'L', '七': 'Q', '八': 'B',
  '九': 'J', '十': 'S', '百': 'B', '千': 'Q', '亿': 'Y',
  '天': 'T', '地': 'D', '人': 'R', '日': 'R', '月': 'Y', '星': 'X', '辰': 'C', '风': 'F',
  '雨': 'Y', '雪': 'X', '霜': 'S', '露': 'L', '雾': 'W', '电': 'D',
  '春': 'C', '冬': 'D', '兰': 'L', '竹': 'Z', '菊': 'J',
  '桃': 'T', '杏': 'X', '梨': 'L',
  '橙': 'C', '绿': 'L', '青': 'Q', '紫': 'Z', '黑': 'H',
  '灰': 'H', '银': 'Y', '铜': 'T', '铁': 'T', '玉': 'Y',
  '河': 'H', '湖': 'H', '溪': 'X', '泉': 'Q',
  '峰': 'F', '岭': 'L', '坡': 'P', '川': 'C', '原': 'Y', '野': 'Y',
  '森': 'S', '木': 'M', '草': 'C', '树': 'S', '根': 'G', '茎': 'J',
  '西': 'X', '南': 'N', '北': 'B', '中': 'Z', '上': 'S', '下': 'X',
  '右': 'Y', '前': 'Q', '里': 'L', '外': 'W', '内': 'N', '旁': 'P',
  '大': 'D', '小': 'X', '长': 'C', '短': 'D', '低': 'D', '宽': 'K', '窄': 'Z',
  '厚': 'H', '深': 'S', '浅': 'Q', '远': 'Y', '近': 'J', '快': 'K', '慢': 'M',
  '弱': 'R', '轻': 'Q', '重': 'Z', '新': 'X', '旧': 'J', '老': 'L', '少': 'S',
  '男': 'N', '女': 'N', '父': 'F', '母': 'M', '兄': 'X', '弟': 'D', '姐': 'J', '妹': 'M',
  '子': 'Z', '夫': 'F', '妻': 'Q', '儿': 'E',
  '虎': 'H', '豹': 'B', '狮': 'S', '象': 'X', '鹰': 'Y',
  '猪': 'Z', '狗': 'G', '猫': 'M', '鸡': 'J', '鸭': 'Y',
  '虾': 'X', '蟹': 'X', '龟': 'G', '蛇': 'S', '鸟': 'N', '蝴': 'H', '蝶': 'D',
  '德': 'D', '道': 'D', '仁': 'R', '义': 'Y', '礼': 'L', '智': 'Z', '信': 'X', '忠': 'Z',
  '孝': 'X', '悌': 'T', '慈': 'C', '诚': 'C', '敬': 'J', '勤': 'Q', '俭': 'J',
  '美': 'M', '善': 'S', '真': 'Z', '好': 'H', '优': 'Y', '秀': 'X', '雅': 'Y', '静': 'J',
  '贤': 'X', '良': 'L', '杰': 'J', '英': 'Y', '雄': 'X', '俊': 'J',
  '才': 'C', '博': 'B', '学': 'X', '书': 'S', '画': 'H',
  '诗': 'S', '词': 'C', '赋': 'F', '棋': 'Q', '剑': 'J', '舞': 'W',
  '亮': 'L', '光': 'G', '辉': 'H', '照': 'Z', '耀': 'Y', '灿': 'C', '烂': 'L',
  '贵': 'G', '旺': 'W', '兴': 'X',
  '祥': 'X', '瑞': 'R', '庆': 'Q', '喜': 'X',
  '健': 'J', '顺': 'S', '泰': 'T',
  '恩': 'E', '慧': 'H', '聪': 'C', '颖': 'Y', '睿': 'R', '捷': 'J',
  '翔': 'X', '飞': 'F', '腾': 'T', '达': 'D', '功': 'G', '胜': 'S',
  '志': 'Z', '望': 'W', '愿': 'Y', '想': 'X', '念': 'N', '思': 'S', '梦': 'M',
  '洁': 'J', '净': 'J', '纯': 'C', '清': 'Q', '素': 'S', '淡': 'D',
  '娟': 'J', '娜': 'N', '婷': 'T', '婉': 'W', '媛': 'Y', '妍': 'Y', '姿': 'Z', '倩': 'Q',
  '丽': 'L', '艳': 'Y', '芳': 'F', '菲': 'F', '蕾': 'L', '薇': 'W', '莲': 'L', '荷': 'H',
  '玲': 'L', '珑': 'L', '珍': 'Z', '珠': 'Z', '琳': 'L', '琪': 'Q', '璇': 'X', '瑶': 'Y',
  '宇': 'Y', '宙': 'Z', '寰': 'H', '宏': 'H', '浩': 'H', '瀚': 'H',
  '伟': 'W', '壮': 'Z', '豪': 'H', '毅': 'Y', '勇': 'Y', '刚': 'G', '坚': 'J',
  '建': 'J', '立': 'L', '创': 'C', '开': 'K', '发': 'F', '展': 'Z', '进': 'J',
  '邦': 'B', '民': 'M', '族': 'Z', '庭': 'T', '室': 'S', '户': 'H',
  '永': 'Y', '恒': 'H', '久': 'J', '持': 'C', '续': 'X', '延': 'Y',
  '嘉': 'J', '佳': 'J', '加': 'J', '佐': 'Z', '佑': 'Y', '保': 'B', '护': 'H',
  '晴': 'Q', '朗': 'L', '晓': 'X', '昕': 'X', '晨': 'C', '曦': 'X',
  '旭': 'X', '昶': 'C', '昊': 'H', '曜': 'Y', '晖': 'H', '映': 'Y',
  '泽': 'Z', '润': 'R', '涵': 'H', '滨': 'B', '潇': 'X', '湘': 'X', '澜': 'L', '澄': 'C',
  '渊': 'Y', '涛': 'T', '波': 'B', '浪': 'L', '流': 'L', '汇': 'H', '源': 'Y', '泓': 'H',
  '奕': 'Y', '弈': 'Y', '奇': 'Q', '轩': 'X', '逸': 'Y', '然': 'R', '尔': 'E', '之': 'Z',
  '乎': 'H', '也': 'Y', '矣': 'Y', '焉': 'Y', '哉': 'Z', '欤': 'Y', '耳': 'E', '者': 'Z'
};

/**
 * 获取单个汉字的拼音首字母
 * @param char 单个汉字
 * @returns 拼音首字母（大写）或空字符串
 */
function getCharPinyinInitial(char: string): string {
  // 如果是英文字母，直接返回大写
  if (/[a-zA-Z]/.test(char)) {
    return char.toUpperCase();
  }

  // 如果是数字，直接返回
  if (/[0-9]/.test(char)) {
    return char;
  }

  // 查找映射表
  if (PINYIN_MAP[char]) {
    return PINYIN_MAP[char];
  }

  // 使用 Unicode 范围来推测拼音首字母
  // 这是一个基于汉字 Unicode 编码范围的近似方法
  const code = char.charCodeAt(0);

  // 基本汉字范围 0x4E00-0x9FFF
  if (code >= 0x4E00 && code <= 0x9FFF) {
    // 使用 GBK 编码范围的近似映射
    // 这个映射不是完全准确的，但可以覆盖大部分常见汉字
    const pinyinIndex = [
      'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'J', 'K', 'L', 'M',
      'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'W', 'X', 'Y', 'Z'
    ];

    // 计算一个粗略的索引（这只是一个近似值）
    const index = Math.floor((code - 0x4E00) / 1000) % pinyinIndex.length;
    return pinyinIndex[index];
  }

  return '';
}

/**
 * 获取中文字符串的拼音首字母
 * @param str 中文字符串
 * @returns 拼音首字母组合（大写）
 */
export function getPinyinInitials(str: string): string {
  if (!str || typeof str !== 'string') {
    return '';
  }

  // 去除空白字符
  const cleanStr = str.trim();

  let result = '';
  for (const char of cleanStr) {
    const initial = getCharPinyinInitial(char);
    if (initial) {
      result += initial;
    }
  }

  return result;
}

/**
 * 生成随机登录码
 * @param length 长度，默认8位
 * @returns 随机登录码（大写字母和数字）
 */
export function generateRandomLoginCode(length: number = 8): string {
  const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
  let result = '';
  for (let i = 0; i < length; i++) {
    const randomIndex = Math.floor(Math.random() * chars.length);
    result += chars[randomIndex];
  }
  return result;
}

export default {
  getPinyinInitials,
  generateRandomLoginCode
};
